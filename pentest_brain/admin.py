from django.contrib import admin
from django.contrib.auth.admin import UserAdmin
from django.contrib.auth.forms import UserChangeForm, UserCreationForm

from pentest_brain.models import Pentester, Sphere, Tag, Command


class PentesterCreationForm(UserCreationForm):
    class Meta(UserCreationForm.Meta):
        model = Pentester
        fields = UserCreationForm.Meta.fields


class PentesterChangeForm(UserChangeForm):
    class Meta(UserChangeForm):
        model = Pentester
        fields = UserCreationForm.Meta.fields


class PentesterAdmin(UserAdmin):
    form = PentesterChangeForm
    add_form = PentesterCreationForm

    fieldsets = (
        (None, {'fields': ('username', 'password', 'first_name', 'last_name', 'email')}),
        ('Custom info', {'fields': ('sphere',)}),
    )

    list_display = ('username', 'first_name', 'last_name', 'sphere')
    list_filter = ('sphere',)


@admin.register(Sphere)
class ScenarioAdmin(admin.ModelAdmin):
    pass


@admin.register(Tag)
class TemplateAdmin(admin.ModelAdmin):
    pass


@admin.register(Command)
class CommandAdmin(admin.ModelAdmin):
    pass


admin.site.register(Pentester, PentesterAdmin)
