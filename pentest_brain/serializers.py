from django_elasticsearch_dsl_drf.serializers import DocumentSerializer
from rest_framework import serializers

from pentest_brain.documents.command import CommandDocument
from pentest_brain.documents.tag import TagDocument
from pentest_brain.models import Pentester, Sphere, Tag, Command


class PentesterSerializer(serializers.ModelSerializer):
    """ Serializer of full user model """

    class Meta:
        model = Pentester
        fields = ('username', 'id', 'first_name', 'last_name', 'sphere')


class SphereSerializer(serializers.ModelSerializer):
    """ Serializer of sphere model """

    class Meta:
        model = Sphere
        fields = ('id', 'name')


class TagSerializer(serializers.ModelSerializer):
    """ Serializer of tag model """

    class Meta:
        model = Tag
        fields = ('id', 'title')


class CommandSerializer(serializers.ModelSerializer):
    """ Serializer of command model """
    tags = TagSerializer(many=True)
    sphere = SphereSerializer()

    class Meta:
        model = Command
        fields = ('id', 'command', 'description', 'tags', 'sphere')


class TagDocumentSerializer(DocumentSerializer):
    class Meta:
        document = TagDocument
        fields = (
            'id',
            'title',
        )


class CommandDocumentSerializer(DocumentSerializer):
    class Meta:
        document = CommandDocument
        fields = (
            'id',
            'command',
            'description',
            'sphere',
            'tags'
        )
