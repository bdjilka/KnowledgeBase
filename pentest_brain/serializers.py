from rest_framework import serializers

from pentest_brain.models import Pentester, Sphere, Tag, Command


class PentesterSerializer(serializers.ModelSerializer):
    """ Serializer of full user model """

    class Meta:
        model = Pentester
        fields = ('username', 'id', 'first_name', 'last_name', 'sphere')


class UserPostSerializer(serializers.ModelSerializer):
    """ Serializer to create user """

    class Meta:
        model = Pentester
        fields = ('email', 'username', 'password')


class UserUpdateSerializer(serializers.ModelSerializer):
    """ Serializer to update user information """

    class Meta:
        model = Pentester
        fields = ('first_name', 'last_name', 'sphere')


class SphereSerializer(serializers.ModelSerializer):
    """ Serializer of sphere model """

    class Meta:
        model = Sphere
        fields = ('id', 'name')


class TagSerializer(serializers.ModelSerializer):
    """ Serializer of tag model """

    class Meta:
        model = Tag
        fields = ('id', 'title')


class CommandSerializer(serializers.ModelSerializer):
    """ Serializer of command model """
    tags = TagSerializer(many=True)
    sphere = SphereSerializer()

    class Meta:
        model = Command
        fields = ('id', 'command', 'description', 'tags', 'sphere')
